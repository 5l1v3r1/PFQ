<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Network.PFq.Default</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Network-PFq-Default.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">PFQ-Lang v4.0</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">Network.PFq.Default</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Predicates
</a></li><li><a href="#g:2">Properties
</a></li><li><a href="#g:3">Combinators
</a></li><li><a href="#g:4">Comparators
</a></li><li><a href="#g:5">Conditionals
</a></li><li><a href="#g:6">Filters
</a></li><li><a href="#g:7">Steering functions
</a></li><li><a href="#g:8">Forwarders
</a></li><li><a href="#g:9">Logging
</a></li><li><a href="#g:10">Bloom Filters
</a></li><li><a href="#g:11">Miscellaneous
</a></li></ul></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><a href="#v:is_ip">is_ip</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:is_udp">is_udp</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:is_tcp">is_tcp</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:is_icmp">is_icmp</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:is_ip6">is_ip6</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:is_udp6">is_udp6</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:is_tcp6">is_tcp6</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:is_icmp6">is_icmp6</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:is_flow">is_flow</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:is_l3_proto">is_l3_proto</a> :: Int16 -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:is_l4_proto">is_l4_proto</a> :: Int8 -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:is_frag">is_frag</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:is_first_frag">is_first_frag</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:is_more_frag">is_more_frag</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:has_port">has_port</a> :: Int16 -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:has_src_port">has_src_port</a> :: Int16 -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:has_dst_port">has_dst_port</a> :: Int16 -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:has_addr">has_addr</a> :: String -&gt; Int -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:has_src_addr">has_src_addr</a> :: String -&gt; Int -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:has_dst_addr">has_dst_addr</a> :: String -&gt; Int -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:has_mark">has_mark</a> :: CULong -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:has_vlan">has_vlan</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:has_vid">has_vid</a> :: CInt -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:vlan_id">vlan_id</a> :: [CInt] -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:ip_tos">ip_tos</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a></li><li class="src short"><a href="#v:ip_tot_len">ip_tot_len</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a></li><li class="src short"><a href="#v:ip_id">ip_id</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a></li><li class="src short"><a href="#v:ip_frag">ip_frag</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a></li><li class="src short"><a href="#v:ip_ttl">ip_ttl</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a></li><li class="src short"><a href="#v:get_mark">get_mark</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a></li><li class="src short"><a href="#v:tcp_source">tcp_source</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a></li><li class="src short"><a href="#v:tcp_dest">tcp_dest</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a></li><li class="src short"><a href="#v:tcp_hdrlen">tcp_hdrlen</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a></li><li class="src short"><a href="#v:udp_source">udp_source</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a></li><li class="src short"><a href="#v:udp_dest">udp_dest</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a></li><li class="src short"><a href="#v:udp_len">udp_len</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a></li><li class="src short"><a href="#v:icmp_type">icmp_type</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a></li><li class="src short"><a href="#v:icmp_code">icmp_code</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a></li><li class="src short"><a href="#v:.-124--124-.">(.||.)</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a> -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a> -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:.-38--38-.">(.&amp;&amp;.)</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a> -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a> -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:.-94--94-.">(.^^.)</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a> -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a> -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:not-39-">not'</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a> -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:inv">inv</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a> -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:par-39-">par'</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a> -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a> -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:.-60-.">(.&lt;.)</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a> -&gt; Word64 -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:.-60--61-.">(.&lt;=.)</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a> -&gt; Word64 -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:.-61--61-.">(.==.)</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a> -&gt; Word64 -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:.-47--61-.">(./=.)</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a> -&gt; Word64 -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:.-62-.">(.&gt;.)</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a> -&gt; Word64 -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:.-62--61-.">(.&gt;=.)</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a> -&gt; Word64 -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:any_bit">any_bit</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a> -&gt; Word64 -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:all_bit">all_bit</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a> -&gt; Word64 -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:conditional">conditional</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a> -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a> -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a> -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:when-39-">when'</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a> -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a> -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:unless-39-">unless'</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a> -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a> -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:filter-39-">filter'</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a> -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:ip">ip</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:ip6">ip6</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:udp">udp</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:tcp">tcp</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:icmp">icmp</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:udp6">udp6</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:tcp6">tcp6</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:icmp6">icmp6</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:vlan">vlan</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:l3_proto">l3_proto</a> :: Int16 -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:l4_proto">l4_proto</a> :: Int8 -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:flow">flow</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:rtp">rtp</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:vlan_id_filter">vlan_id_filter</a> :: [CInt] -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:no_frag">no_frag</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:no_more_frag">no_more_frag</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:port">port</a> :: Int16 -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:src_port">src_port</a> :: Int16 -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:dst_port">dst_port</a> :: Int16 -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:addr">addr</a> :: String -&gt; Int -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:src_addr">src_addr</a> :: String -&gt; Int -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:dst_addr">dst_addr</a> :: String -&gt; Int -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:steer_link">steer_link</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:steer_vlan">steer_vlan</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:steer_ip">steer_ip</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:steer_ip6">steer_ip6</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:steer_flow">steer_flow</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:steer_rtp">steer_rtp</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:steer_net">steer_net</a> :: String -&gt; Int -&gt; Int -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:steer_field">steer_field</a> :: CInt -&gt; CInt -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:kernel">kernel</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:broadcast">broadcast</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:drop-39-">drop'</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:forward">forward</a> :: String -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:forwardIO">forwardIO</a> :: String -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:bridge">bridge</a> :: String -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:tee">tee</a> :: String -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a> -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:tap">tap</a> :: String -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a> -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:log_msg">log_msg</a> :: String -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:log_buff">log_buff</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:log_packet">log_packet</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:bloom">bloom</a> :: CInt -&gt; [HostName] -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:bloom_src">bloom_src</a> :: CInt -&gt; [HostName] -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:bloom_dst">bloom_dst</a> :: CInt -&gt; [HostName] -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></li><li class="src short"><a href="#v:bloom_filter">bloom_filter</a> :: CInt -&gt; [HostName] -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:bloom_src_filter">bloom_src_filter</a> :: CInt -&gt; [HostName] -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:bloom_dst_filter">bloom_dst_filter</a> :: CInt -&gt; [HostName] -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:bloomCalcN">bloomCalcN</a> :: Int -&gt; Double -&gt; Int</li><li class="src short"><a href="#v:bloomCalcM">bloomCalcM</a> :: Int -&gt; Double -&gt; Int</li><li class="src short"><a href="#v:bloomCalcP">bloomCalcP</a> :: Int -&gt; Int -&gt; Double</li><li class="src short"><a href="#v:unit">unit</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:inc">inc</a> :: CInt -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:dec">dec</a> :: CInt -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li><li class="src short"><a href="#v:mark">mark</a> :: CULong -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></li></ul></div><div id="interface"><h1 id="g:1">Predicates
</h1><div class="doc"><p>Collection of predicates used in conditional expressions.
</p></div><div class="top"><p class="src"><a name="v:is_ip" class="def">is_ip</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></p><div class="doc"><p>Evaluate to <em>True</em> if the SkBuff is an IPv4 packet.
</p></div></div><div class="top"><p class="src"><a name="v:is_udp" class="def">is_udp</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></p><div class="doc"><p>Evaluate to <em>True</em> if the SkBuff is an UDP packet.
</p></div></div><div class="top"><p class="src"><a name="v:is_tcp" class="def">is_tcp</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></p><div class="doc"><p>Evaluate to <em>True</em> if the SkBuff is a TCP packet.
</p></div></div><div class="top"><p class="src"><a name="v:is_icmp" class="def">is_icmp</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></p><div class="doc"><p>Evaluate to <em>True</em> if the SkBuff is an ICMP packet.
</p></div></div><div class="top"><p class="src"><a name="v:is_ip6" class="def">is_ip6</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></p><div class="doc"><p>Evaluate to <em>True</em> if the SkBuff is an IPv6 packet.
</p></div></div><div class="top"><p class="src"><a name="v:is_udp6" class="def">is_udp6</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></p><div class="doc"><p>Evaluate to <em>True</em> if the SkBuff is an UDP packet, on top of IPv6.
</p></div></div><div class="top"><p class="src"><a name="v:is_tcp6" class="def">is_tcp6</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></p><div class="doc"><p>Evaluate to <em>True</em> if the SkBuff is a TCP packet, on top of IPv6.
</p></div></div><div class="top"><p class="src"><a name="v:is_icmp6" class="def">is_icmp6</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></p><div class="doc"><p>Evaluate to <em>True</em> if the SkBuff is an ICMP packet, on top of IPv6.
</p></div></div><div class="top"><p class="src"><a name="v:is_flow" class="def">is_flow</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></p><div class="doc"><p>Evaluate to <em>True</em> if the SkBuff is an UDP or TCP packet.
</p></div></div><div class="top"><p class="src"><a name="v:is_l3_proto" class="def">is_l3_proto</a> :: Int16 -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></p><div class="doc"><p>Evaluate to <em>True</em> if the SkBuff has the given Layer3 protocol.
</p></div></div><div class="top"><p class="src"><a name="v:is_l4_proto" class="def">is_l4_proto</a> :: Int8 -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></p><div class="doc"><p>Evaluate to <em>True</em> if the SkBuff has the given Layer4 protocol.
</p></div></div><div class="top"><p class="src"><a name="v:is_frag" class="def">is_frag</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></p><div class="doc"><p>Evaluate to <em>True</em> if the SkBuff is a TCP fragment.
</p></div></div><div class="top"><p class="src"><a name="v:is_first_frag" class="def">is_first_frag</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></p><div class="doc"><p>Evaluate to <em>True</em> if the SkBuff is the first TCP fragment.
</p></div></div><div class="top"><p class="src"><a name="v:is_more_frag" class="def">is_more_frag</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></p><div class="doc"><p>Evaluate to <em>True</em> if the SkBuff is a TCP fragment, but the first.
</p></div></div><div class="top"><p class="src"><a name="v:has_port" class="def">has_port</a> :: Int16 -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></p><div class="doc"><p>Evaluate to <em>True</em> if the SkBuff has the given source or destination port.
</p><p>If the transport protocol is not present or has no port, the predicate evaluates to False.
</p><pre> has_port 80
</pre></div></div><div class="top"><p class="src"><a name="v:has_src_port" class="def">has_src_port</a> :: Int16 -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></p><div class="doc"><p>Evaluate to <em>True</em> if the SkBuff has the given source port.
</p><p>If the transport protocol is not present or has no port, the predicate evaluates to False.
</p></div></div><div class="top"><p class="src"><a name="v:has_dst_port" class="def">has_dst_port</a> :: Int16 -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></p><div class="doc"><p>Evaluate to <em>True</em> if the SkBuff has the given destination port.
</p><p>If the transport protocol is not present or has no port, the predicate evaluates to False.
</p></div></div><div class="top"><p class="src"><a name="v:has_addr" class="def">has_addr</a> :: String -&gt; Int -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></p><div class="doc"><p>Evaluate to <em>True</em> if the source or destination IP address matches the given network address. I.e.,
</p><pre> has_addr &quot;192.168.0.0&quot; 24
</pre></div></div><div class="top"><p class="src"><a name="v:has_src_addr" class="def">has_src_addr</a> :: String -&gt; Int -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></p><div class="doc"><p>Evaluate to <em>True</em> if the source IP address matches the given network address.
</p></div></div><div class="top"><p class="src"><a name="v:has_dst_addr" class="def">has_dst_addr</a> :: String -&gt; Int -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></p><div class="doc"><p>Evaluate to <em>True</em> if the destination IP address matches the given network address.
</p></div></div><div class="top"><p class="src"><a name="v:has_mark" class="def">has_mark</a> :: CULong -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></p><div class="doc"><p>Evaluate to <em>True</em> if the SkBuff has the given mark, set by <code><a href="Network-PFq-Default.html#v:mark">mark</a></code> function.
</p><pre> has_mark 11
</pre></div></div><div class="top"><p class="src"><a name="v:has_vlan" class="def">has_vlan</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></p><div class="doc"><p>Evaluate to <em>True</em> if the SkBuff has a vlan tag.
</p></div></div><div class="top"><p class="src"><a name="v:has_vid" class="def">has_vid</a> :: CInt -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></p><div class="doc"><p>Evaluate to <em>True</em> if the SkBuff has the given vlan id.
</p><pre> has_vid 42
</pre></div></div><div class="top"><p class="src"><a name="v:vlan_id" class="def">vlan_id</a> :: [CInt] -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></p><div class="doc"><p>Predicate which evaluates to <em>True</em> when the packet has one of the
 vlan id specified by the list. Example:
</p><pre> when' (vland_id [1,13,42,43]) msg_log &quot;Got a packet!&quot;
</pre></div></div><h1 id="g:2">Properties
</h1><div class="top"><p class="src"><a name="v:ip_tos" class="def">ip_tos</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a></p><div class="doc"><p>Evaluate to the <em>tos</em> field of the IP header.
</p></div></div><div class="top"><p class="src"><a name="v:ip_tot_len" class="def">ip_tot_len</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a></p><div class="doc"><p>Evaluate to the <em>tot_len</em> field of the IP header.
</p></div></div><div class="top"><p class="src"><a name="v:ip_id" class="def">ip_id</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a></p><div class="doc"><p>Evaluate to the <em>ip_id</em> field of the IP header.
</p></div></div><div class="top"><p class="src"><a name="v:ip_frag" class="def">ip_frag</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a></p><div class="doc"><p>Evaluate to the <em>frag</em> field of the IP header.
</p></div></div><div class="top"><p class="src"><a name="v:ip_ttl" class="def">ip_ttl</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a></p><div class="doc"><p>Evaluate to the <em>TTL</em> field of the IP header.
</p></div></div><div class="top"><p class="src"><a name="v:get_mark" class="def">get_mark</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a></p><div class="doc"><p>Evaluate to the mark set by <code><a href="Network-PFq-Default.html#v:mark">mark</a></code> function. By default packets are marked with 0.
</p></div></div><div class="top"><p class="src"><a name="v:tcp_source" class="def">tcp_source</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a></p><div class="doc"><p>Evaluate to the <em>source port</em> of the TCP header.
</p></div></div><div class="top"><p class="src"><a name="v:tcp_dest" class="def">tcp_dest</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a></p><div class="doc"><p>Evaluate to the <em>destination port</em> of the TCP header.
</p></div></div><div class="top"><p class="src"><a name="v:tcp_hdrlen" class="def">tcp_hdrlen</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a></p><div class="doc"><p>Evaluate to the <em>length</em> field of the TCP header.
</p></div></div><div class="top"><p class="src"><a name="v:udp_source" class="def">udp_source</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a></p><div class="doc"><p>Evaluate to the <em>source port</em> of the UDP header.
</p></div></div><div class="top"><p class="src"><a name="v:udp_dest" class="def">udp_dest</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a></p><div class="doc"><p>Evaluate to the <em>destination port</em> of the UDP header.
</p></div></div><div class="top"><p class="src"><a name="v:udp_len" class="def">udp_len</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a></p><div class="doc"><p>Evaluate to the <em>length</em> field of the UDP header.
</p></div></div><div class="top"><p class="src"><a name="v:icmp_type" class="def">icmp_type</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a></p><div class="doc"><p>Evaluate to the <em>type</em> field of the ICMP header.
</p></div></div><div class="top"><p class="src"><a name="v:icmp_code" class="def">icmp_code</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a></p><div class="doc"><p>Evaluate to the <em>code</em> field of the ICMP header.
</p></div></div><h1 id="g:3">Combinators
</h1><div class="top"><p class="src"><a name="v:.-124--124-." class="def">(.||.)</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a> -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a> -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></p><div class="doc"><p>Combine two predicate expressions with a specific boolean <em>or</em> operation.
</p></div></div><div class="top"><p class="src"><a name="v:.-38--38-." class="def">(.&amp;&amp;.)</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a> -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a> -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></p><div class="doc"><p>Combine two predicate expressions with a specific boolean <em>and</em> operation.
</p></div></div><div class="top"><p class="src"><a name="v:.-94--94-." class="def">(.^^.)</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a> -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a> -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></p><div class="doc"><p>Combine two predicate expressions with a specific boolean <em>xor</em> operation.
</p></div></div><div class="top"><p class="src"><a name="v:not-39-" class="def">not'</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a> -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></p><div class="doc"><p>Return a new predicate that evaluates to <em>True</em>, when the given one evaluates to
 false, and vice versa.
</p></div></div><div class="top"><p class="src"><a name="v:inv" class="def">inv</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a> -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Function that inverts a monadic NetFunction. Useful to invert filters:
</p><pre> inv ip &gt;-&gt; log_msg &quot;This is not an IPv4 Packet&quot;
</pre></div></div><div class="top"><p class="src"><a name="v:par-39-" class="def">par'</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a> -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a> -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Function that returns the parallel of two monadic NetFunctions.
</p><p>Logic <code>or</code> for monadic filters:
</p><pre> par' udp icmp &gt;-&gt; log_msg &quot;This is an UDP or ICMP Packet&quot;
</pre></div></div><h1 id="g:4">Comparators
</h1><div class="doc"><p>Take a NetProperty, a value, and return a predicate that compares the values.
</p></div><div class="top"><p class="src"><a name="v:.-60-." class="def">(.&lt;.)</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a> -&gt; Word64 -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></p><div class="doc"><p>Return a predicate that evaluates to <em>True</em>, if the property is less than
 the given value. Example:
</p><pre>  when' (ip_ttl .&lt;. 64) drop'
</pre></div></div><div class="top"><p class="src"><a name="v:.-60--61-." class="def">(.&lt;=.)</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a> -&gt; Word64 -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></p></div><div class="top"><p class="src"><a name="v:.-61--61-." class="def">(.==.)</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a> -&gt; Word64 -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></p></div><div class="top"><p class="src"><a name="v:.-47--61-." class="def">(./=.)</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a> -&gt; Word64 -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></p></div><div class="top"><p class="src"><a name="v:.-62-." class="def">(.&gt;.)</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a> -&gt; Word64 -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></p></div><div class="top"><p class="src"><a name="v:.-62--61-." class="def">(.&gt;=.)</a> :: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a> -&gt; Word64 -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></p></div><div class="top"><p class="src"><a name="v:any_bit" class="def">any_bit</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; Word64</td><td class="doc"><p>comparison mask
</p></td></tr><tr><td class="src">-&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Return a predicate that evaluates to <em>True</em>, if the property has at least
 one bit set among those specified by the given mask.
</p></div></div><div class="top"><p class="src"><a name="v:all_bit" class="def">all_bit</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Network-PFq-Lang.html#t:NetProperty">NetProperty</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; Word64</td><td class="doc"><p>comparison mask
</p></td></tr><tr><td class="src">-&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Return a predicate that evaluates to <em>True</em>, if the property has all bits
 set among those specified in the given mask.
</p></div></div><h1 id="g:5">Conditionals
</h1><div class="top"><p class="src"><a name="v:conditional" class="def">conditional</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a> -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a> -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a> -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>conditional execution of monadic netfunctions.
</p><p>the function takes a predicate and evaluates to the first or the second expression, depending on the
 value returned by the predicate. Example:
</p><pre> conditional is_udp (forward &quot;eth1&quot;) (forward &quot;eth2&quot;)
</pre></div></div><div class="top"><p class="src"><a name="v:when-39-" class="def">when'</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a> -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a> -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Conditional execution of monadic NetFunctions.
</p><p>The function takes a predicate and evaluates to given the NetFunction when it evalutes to <em>True</em>,
 otherwise does nothing.
 Example:
</p><pre> when' is_tcp (log_msg &quot;This is a TCP Packet&quot;)
</pre></div></div><div class="top"><p class="src"><a name="v:unless-39-" class="def">unless'</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a> -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a> -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>The reverse of <a href="when'.html">when'</a>
</p></div></div><h1 id="g:6">Filters
</h1><div class="doc"><p>A collection of monadic NetFunctions.
</p></div><div class="top"><p class="src"><a name="v:filter-39-" class="def">filter'</a> :: <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a> -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Transform the given predicate in its counterpart monadic version.
 Example:
</p><pre> filter' is_udp &gt;-&gt; kernel
</pre><p>is logically equivalent to:
</p><pre> udp &gt;-&gt; kernel
</pre></div></div><div class="top"><p class="src"><a name="v:ip" class="def">ip</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Evaluate to <em>Pass SkBuff</em> if it is an IPv4 packet, <em>Drop</em> it otherwise.
</p></div></div><div class="top"><p class="src"><a name="v:ip6" class="def">ip6</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Evaluate to <em>Pass SkBuff</em> if it is an IPv6 packet, <em>Drop</em> it otherwise.
</p></div></div><div class="top"><p class="src"><a name="v:udp" class="def">udp</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Evaluate to <em>Pass SkBuff</em> if it is an UDP packet, <em>Drop</em> it otherwise.
</p></div></div><div class="top"><p class="src"><a name="v:tcp" class="def">tcp</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Evaluate to <em>Pass SkBuff</em> if it is a TCP packet, <em>Drop</em> it otherwise.
</p></div></div><div class="top"><p class="src"><a name="v:icmp" class="def">icmp</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Evaluate to <em>Pass SkBuff</em> if it is an ICMP packet, <em>Drop</em> it otherwise.
</p></div></div><div class="top"><p class="src"><a name="v:udp6" class="def">udp6</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Evaluate to <em>Pass SkBuff</em> if it is an UDP packet (on top of IPv6), <em>Drop</em> it otherwise.
</p></div></div><div class="top"><p class="src"><a name="v:tcp6" class="def">tcp6</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Evaluate to <em>Pass SkBuff</em> if it is a TCP packet (on top of IPv6), <em>Drop</em> it otherwise.
</p></div></div><div class="top"><p class="src"><a name="v:icmp6" class="def">icmp6</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Evaluate to <em>Pass SkBuff</em> if it is an ICMP packet (on top of IPv6), <em>Drop</em> it otherwise.
</p></div></div><div class="top"><p class="src"><a name="v:vlan" class="def">vlan</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Evaluate to <em>Pass SkBuff</em> if it has a vlan tag, <em>Drop</em> it otherwise.
</p></div></div><div class="top"><p class="src"><a name="v:l3_proto" class="def">l3_proto</a> :: Int16 -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Monadic version of <code><a href="Network-PFq-Default.html#v:is_l3_proto">is_l3_proto</a></code> predicate.
</p><p>Predicates are used in conditional expressions, while monadic functions
 are combined with Kleisli operator:
</p><pre> l3_proto 0x842 &gt;-&gt; log_msg &quot;Wake-on-LAN packet!&quot;
</pre></div></div><div class="top"><p class="src"><a name="v:l4_proto" class="def">l4_proto</a> :: Int8 -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Monadic version of <code><a href="Network-PFq-Default.html#v:is_l4_proto">is_l4_proto</a></code> predicate.
</p><p>Predicates are used in conditional expressions, while monadic functions
 are combined with Kleisli operator:
</p><pre> l4_proto 89 &gt;-&gt; log_msg &quot;OSFP packet!&quot;
</pre></div></div><div class="top"><p class="src"><a name="v:flow" class="def">flow</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Evaluate to <em>Pass SkBuff</em> if it is a TCP or UDP packet, <em>Drop</em> it otherwise.
</p></div></div><div class="top"><p class="src"><a name="v:rtp" class="def">rtp</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Evaluate to <em>Pass SkBuff</em> if it is a RTP<em>RTCP packet, </em>Drop/ it otherwise.
</p></div></div><div class="top"><p class="src"><a name="v:vlan_id_filter" class="def">vlan_id_filter</a> :: [CInt] -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Monadic function, counterpart of <code><a href="Network-PFq-Default.html#v:vlan_id">vlan_id</a></code> function.
</p></div></div><div class="top"><p class="src"><a name="v:no_frag" class="def">no_frag</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Evaluate to <em>Pass SkBuff</em> if it is not a fragment, <em>Drop</em> it otherwise.
</p></div></div><div class="top"><p class="src"><a name="v:no_more_frag" class="def">no_more_frag</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Evaluate to <em>Pass SkBuff</em> if it is not a fragment or if it's the first fragment, <em>Drop</em> it otherwise.
</p></div></div><div class="top"><p class="src"><a name="v:port" class="def">port</a> :: Int16 -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Monadic version of <code><a href="Network-PFq-Default.html#v:has_port">has_port</a></code> predicate.
</p><p>Predicates are used in conditional expressions, while monadic functions
 are combined with Kleisli operator:
</p><pre> port 80 &gt;-&gt; log_msg &quot;http packet!&quot;
</pre></div></div><div class="top"><p class="src"><a name="v:src_port" class="def">src_port</a> :: Int16 -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Monadic version of <code><a href="Network-PFq-Default.html#v:has_src_port">has_src_port</a></code> predicate.
</p></div></div><div class="top"><p class="src"><a name="v:dst_port" class="def">dst_port</a> :: Int16 -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Monadic version of <code><a href="Network-PFq-Default.html#v:has_dst_port">has_dst_port</a></code> predicate.
</p></div></div><div class="top"><p class="src"><a name="v:addr" class="def">addr</a> :: String -&gt; Int -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Monadic version of <code><a href="Network-PFq-Default.html#v:has_addr">has_addr</a></code> predicate.
</p><p>predicates are used in conditional expressions, while monadic functions
 are combined with kleisli operator:
</p><pre> addr &quot;192.168.0.0&quot; 24 &gt;-&gt; log_packet
</pre></div></div><div class="top"><p class="src"><a name="v:src_addr" class="def">src_addr</a> :: String -&gt; Int -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Monadic version of <code><a href="Network-PFq-Default.html#v:has_src_addr">has_src_addr</a></code> predicate.
</p></div></div><div class="top"><p class="src"><a name="v:dst_addr" class="def">dst_addr</a> :: String -&gt; Int -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Monadic version of <code><a href="Network-PFq-Default.html#v:has_src_addr">has_src_addr</a></code> predicate.
</p></div></div><h1 id="g:7">Steering functions
</h1><div class="doc"><p>Monadic functions used to dispatch packets across sockets.
 They evaluate to <em>Steer Hash Skbuff</em>, if the packet has a certain property, <em>Drop</em> otherwise.
</p></div><div class="top"><p class="src"><a name="v:steer_link" class="def">steer_link</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Dispatch the packet across the sockets
 with a randomized algorithm that maintains the integrity of
 physical links.
</p><pre> ip &gt;-&gt; steer_link
</pre></div></div><div class="top"><p class="src"><a name="v:steer_vlan" class="def">steer_vlan</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Dispatch the packet across the sockets
 with a randomized algorithm that maintains the integrity of
 vlan links.
</p><pre> steer_vlan
</pre></div></div><div class="top"><p class="src"><a name="v:steer_ip" class="def">steer_ip</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Dispatch the packet across the sockets
 with a randomized algorithm that maintains the integrity of
 IP flows.
</p><pre> steer_ip
</pre></div></div><div class="top"><p class="src"><a name="v:steer_ip6" class="def">steer_ip6</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Dispatch the packet across the sockets
 with a randomized algorithm that maintains the integrity of
 IPv6 flows.
</p><pre> steer_ip6 &gt;-&gt; log_msg &quot;Steering an IPv6 packet&quot;
</pre></div></div><div class="top"><p class="src"><a name="v:steer_flow" class="def">steer_flow</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Dispatch the packet across the sockets
 with a randomized algorithm that maintains the integrity of
 TCP/UDP flows.
</p><pre> steer_flow &gt;-&gt; log_msg &quot;Steering a flow&quot;
</pre></div></div><div class="top"><p class="src"><a name="v:steer_rtp" class="def">steer_rtp</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Dispatch the packet across the sockets
 with a randomized algorithm that maintains the integrity of
 RTP/RTCP flows.
</p><pre> steer_rtp
</pre></div></div><div class="top"><p class="src"><a name="v:steer_net" class="def">steer_net</a> :: String -&gt; Int -&gt; Int -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Dispatch the packet across the sockets
 with a randomized algorithm that maintains the integrity of
 sub networks.
</p><pre> steer_net &quot;192.168.0.0&quot; 16 24
</pre></div></div><div class="top"><p class="src"><a name="v:steer_field" class="def">steer_field</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: CInt</td><td class="doc"><p>offset from the beginning of the packet, in bytes
</p></td></tr><tr><td class="src">-&gt; CInt</td><td class="doc"><p>sizeof field in bits
</p></td></tr><tr><td class="src">-&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Dispatch the packet across the sockets
 with a randomized algorithm. The function uses as <em>hash</em> the field
 of <em>size</em> bits taken at <em>offset</em> bytes from the beginning of the packet.
</p></div></div><h1 id="g:8">Forwarders
</h1><div class="top"><p class="src"><a name="v:kernel" class="def">kernel</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Send a copy of the packet to the kernel (the sk_buff may have been captured directly
 by PFQ).
</p><p>To avoid loop, this function is ignored for packets sniffed from the kernel.
</p></div></div><div class="top"><p class="src"><a name="v:broadcast" class="def">broadcast</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Broadcast the packet to all the sockets that have joined the group for which this computation
 is specified.
</p></div></div><div class="top"><p class="src"><a name="v:drop-39-" class="def">drop'</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Drop the packet. The computation evaluates to <em>Drop</em>.
</p></div></div><div class="top"><p class="src"><a name="v:forward" class="def">forward</a> :: String -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Forward the packet to the given device.
 This function is lazy, in that the action is logged and performed
 when the computation is completely evaluated.
</p><pre> forward &quot;eth1&quot;
</pre></div></div><div class="top"><p class="src"><a name="v:forwardIO" class="def">forwardIO</a> :: String -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Forward the packet to the given device. This operation breaks the purity of the language,
 and it is possibly slower than the lazy <a href="forward.html">forward</a> counterpart.
</p><pre> forwardIO &quot;eth1&quot;
</pre></div></div><div class="top"><p class="src"><a name="v:bridge" class="def">bridge</a> :: String -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Forward the packet to the given device and evaluates to <em>Drop</em>. Example:
</p><pre> when' is_udp (bridge &quot;eth1&quot;) &gt;-&gt; kernel
</pre><p>Conditional bridge, forward the packet to eth1 if UDP, send it to the kernel
 otherwise.
</p></div></div><div class="top"><p class="src"><a name="v:tee" class="def">tee</a> :: String -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a> -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Forward the packet to the given device and, evaluates to <em>Pass SkBuff</em> or <em>Drop</em>,
 depending on the value returned by the predicate. Example:
</p><pre> tee &quot;eth1&quot; is_udp &gt;-&gt; kernel
</pre><p>Logically equivalent to:
</p><pre> forward &quot;eth1&quot; &gt;-&gt; udp &gt;-&gt; kernel
</pre><p>Only a little bit more efficient.
</p></div></div><div class="top"><p class="src"><a name="v:tap" class="def">tap</a> :: String -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a> -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Evaluate to <em>Pass SkBuff</em>, or forward the packet to the given device and evaluate to <em>Drop</em>,
 depending on the value returned by the predicate. Example:
</p><pre> tap &quot;eth1&quot; is_udp &gt;-&gt; kernel
</pre><p>Logically equivalent to:
</p><pre> unless' is_udp (forward &quot;eth1&quot; &gt;-&gt; drop') &gt;-&gt; kernel
</pre><p>Only a little bit more efficient.
</p></div></div><h1 id="g:9">Logging
</h1><div class="top"><p class="src"><a name="v:log_msg" class="def">log_msg</a> :: String -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Log a message to syslog.
</p><pre> udp &gt;-&gt; log_msg &quot;This is an UDP packet&quot;
</pre></div></div><div class="top"><p class="src"><a name="v:log_buff" class="def">log_buff</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Dump the payload of packet to syslog.
</p><pre> icmp &gt;-&gt; log_buff
</pre></div></div><div class="top"><p class="src"><a name="v:log_packet" class="def">log_packet</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Log the packet to syslog, with a syntax similar to tcpdump.
</p><pre> icmp &gt;-&gt; log_msg &quot;This is an ICMP packet:&quot; &gt;-&gt; log_packet
</pre></div></div><h1 id="g:10">Bloom Filters
</h1><div class="top"><p class="src"><a name="v:bloom" class="def">bloom</a> :: CInt -&gt; [HostName] -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></p><div class="doc"><p>Predicate that evaluates to <em>True</em> when the source or the destination address
 of the packet matches the ones specified by the bloom list.
</p><p>The first <code>CInt</code> argument specifies the size of the bloom filter. Example:
</p><pre> when' (bloom 1024 [&quot;192.168.0.13&quot;, &quot;192.168.0.42&quot;]) log_packet &gt;-&gt; kernel
</pre></div></div><div class="top"><p class="src"><a name="v:bloom_src" class="def">bloom_src</a> :: CInt -&gt; [HostName] -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></p><div class="doc"><p>Similarly to <code><a href="Network-PFq-Default.html#v:bloom">bloom</a></code>, evaluates to <em>True</em> when the source address
 of the packet matches the ones specified by the bloom list.
</p></div></div><div class="top"><p class="src"><a name="v:bloom_dst" class="def">bloom_dst</a> :: CInt -&gt; [HostName] -&gt; <a href="Network-PFq-Lang.html#t:NetPredicate">NetPredicate</a></p><div class="doc"><p>Similarly to <code><a href="Network-PFq-Default.html#v:bloom">bloom</a></code>, evaluates to <em>True</em> when the destination address
 of the packet matches the ones specified by the bloom list.
</p></div></div><div class="top"><p class="src"><a name="v:bloom_filter" class="def">bloom_filter</a> :: CInt -&gt; [HostName] -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Monadic counterpart of <code><a href="Network-PFq-Default.html#v:bloom">bloom</a></code> function.
</p></div></div><div class="top"><p class="src"><a name="v:bloom_src_filter" class="def">bloom_src_filter</a> :: CInt -&gt; [HostName] -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Monadic counterpart of <code><a href="Network-PFq-Default.html#v:bloom_src">bloom_src</a></code> function.
</p></div></div><div class="top"><p class="src"><a name="v:bloom_dst_filter" class="def">bloom_dst_filter</a> :: CInt -&gt; [HostName] -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Monadic counterpart of <code><a href="Network-PFq-Default.html#v:bloom_dst">bloom_dst</a></code> function.
</p></div></div><div class="top"><p class="src"><a name="v:bloomCalcN" class="def">bloomCalcN</a> :: Int -&gt; Double -&gt; Int</p><div class="doc"><p>Bloom filter: utility function that computes the optimal <em>N</em>, given the parameter <em>M</em> and
 the false-positive probability <em>p</em>.
</p></div></div><div class="top"><p class="src"><a name="v:bloomCalcM" class="def">bloomCalcM</a> :: Int -&gt; Double -&gt; Int</p><div class="doc"><p>Bloom filter: utility function that computes the optimal <em>M</em>, given the parameter <em>N</em> and
 the false-positive probability <em>p</em>.
</p></div></div><div class="top"><p class="src"><a name="v:bloomCalcP" class="def">bloomCalcP</a> :: Int -&gt; Int -&gt; Double</p><div class="doc"><p>Bloom filter: utility function that computes the false positive P, given <em>N</em> and <em>M</em> parameters.
</p></div></div><h1 id="g:11">Miscellaneous
</h1><div class="top"><p class="src"><a name="v:unit" class="def">unit</a> :: <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Unit operation implements left- and right-identity for Action monad.
</p></div></div><div class="top"><p class="src"><a name="v:inc" class="def">inc</a> :: CInt -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Increment the i-th counter of the current group.
</p><pre> inc 10
</pre></div></div><div class="top"><p class="src"><a name="v:dec" class="def">dec</a> :: CInt -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Decrement the i-th counter of the current group.
</p><pre> dec 10
</pre></div></div><div class="top"><p class="src"><a name="v:mark" class="def">mark</a> :: CULong -&gt; <a href="Network-PFq-Lang.html#t:NetFunction">NetFunction</a></p><div class="doc"><p>Mark the packet with the given value.
</p><pre> mark 42
</pre></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.13.2</p></div></body></html>