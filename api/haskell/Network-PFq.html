<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Network.PFq</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Network-PFq.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption empty">&nbsp;</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Portability</th><td>non-portable</td></tr><tr><th>Stability</th><td>experimental</td></tr><tr><th>Maintainer</th><td>nicola.bonelli@cnit.it</td></tr><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">Network.PFq</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Types
</a></li><li><a href="#g:2">Socket and Groups
</a></li><li><a href="#g:3">Packet capture
</a></li><li><a href="#g:4">Packet transmission
</a></li><li><a href="#g:5">Q-lang
</a></li><li><a href="#g:6">Statistics and counters
</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>The <code><a href="Network.html#t:PFq">PFq</a></code> module is a low level binding to the
 functions in <code>libpfq</code>.  See <a href="https://github.com/pfq/PFQ/wiki">https://github.com/pfq/PFQ/wiki</a> for more
 information.
</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">data</span>  <a href="#t:PFqTag">PFqTag</a> </li><li class="src short"><span class="keyword">data</span>  <a href="#t:Statistics">Statistics</a>  = <a href="#v:Statistics">Statistics</a> {<ul class="subs"><li><a href="#v:sReceived">sReceived</a> :: Integer</li><li><a href="#v:sLost">sLost</a> :: Integer</li><li><a href="#v:sDropped">sDropped</a> :: Integer</li><li><a href="#v:sSent">sSent</a> :: Integer</li><li><a href="#v:sDiscard">sDiscard</a> :: Integer</li></ul>}</li><li class="src short"><span class="keyword">data</span>  <a href="#t:NetQueue">NetQueue</a>  = <a href="#v:NetQueue">NetQueue</a> {<ul class="subs"><li><a href="#v:qPtr">qPtr</a> :: Ptr <a href="Network-PFq.html#t:PktHdr">PktHdr</a></li><li><a href="#v:qLen">qLen</a> :: !Word64</li><li><a href="#v:qSlotSize">qSlotSize</a> :: !Word64</li><li><a href="#v:qIndex">qIndex</a> :: !Word32</li></ul>}</li><li class="src short"><span class="keyword">data</span>  <a href="#t:Packet">Packet</a>  = <a href="#v:Packet">Packet</a> {<ul class="subs"><li><a href="#v:pHdr">pHdr</a> :: Ptr <a href="Network-PFq.html#t:PktHdr">PktHdr</a></li><li><a href="#v:pData">pData</a> :: Ptr Word8</li><li><a href="#v:pIndex">pIndex</a> :: !Word32</li></ul>}</li><li class="src short"><span class="keyword">data</span>  <a href="#t:PktHdr">PktHdr</a>  = <a href="#v:PktHdr">PktHdr</a> {<ul class="subs"><li><a href="#v:hData">hData</a> :: !Word64</li><li><a href="#v:hSec">hSec</a> :: !Word32</li><li><a href="#v:hNsec">hNsec</a> :: !Word32</li><li><a href="#v:hIfIndex">hIfIndex</a> :: !Word32</li><li><a href="#v:hGid">hGid</a> :: !Word32</li><li><a href="#v:hLen">hLen</a> :: !Word16</li><li><a href="#v:hCapLen">hCapLen</a> :: !Word16</li><li><a href="#v:hTci">hTci</a> :: !Word16</li><li><a href="#v:hHwQueue">hHwQueue</a> :: !Word8</li><li><a href="#v:hCommit">hCommit</a> :: !Word8</li></ul>}</li><li class="src short"><span class="keyword">type</span> <a href="#t:Callback">Callback</a> = <a href="Network-PFq.html#t:PktHdr">PktHdr</a> -&gt; Ptr Word8 -&gt; IO ()</li><li class="src short"><span class="keyword">newtype</span>  <a href="#t:ClassMask">ClassMask</a>  = <a href="#v:ClassMask">ClassMask</a> {<ul class="subs"><li><a href="#v:getClassMask">getClassMask</a> :: CULong</li></ul>}</li><li class="src short"><a href="#v:class_default">class_default</a> :: <a href="Network-PFq.html#t:ClassMask">ClassMask</a></li><li class="src short"><a href="#v:class_any">class_any</a> :: <a href="Network-PFq.html#t:ClassMask">ClassMask</a></li><li class="src short"><span class="keyword">newtype</span>  <a href="#t:GroupPolicy">GroupPolicy</a>  = <a href="#v:GroupPolicy">GroupPolicy</a> {<ul class="subs"><li><a href="#v:getGroupPolicy">getGroupPolicy</a> :: CInt</li></ul>}</li><li class="src short"><a href="#v:policy_undefined">policy_undefined</a> :: <a href="Network-PFq.html#t:GroupPolicy">GroupPolicy</a></li><li class="src short"><a href="#v:policy_priv">policy_priv</a> :: <a href="Network-PFq.html#t:GroupPolicy">GroupPolicy</a></li><li class="src short"><a href="#v:policy_restricted">policy_restricted</a> :: <a href="Network-PFq.html#t:GroupPolicy">GroupPolicy</a></li><li class="src short"><a href="#v:policy_shared">policy_shared</a> :: <a href="Network-PFq.html#t:GroupPolicy">GroupPolicy</a></li><li class="src short"><span class="keyword">newtype</span>  <a href="#t:PFqConstant">PFqConstant</a>  = <a href="#v:PFqConstant">PFqConstant</a> {<ul class="subs"><li><a href="#v:getConstant">getConstant</a> :: Int</li></ul>}</li><li class="src short"><a href="#v:open">open</a> :: Int -&gt; Int -&gt; Int -&gt; IO (ForeignPtr <a href="Network-PFq.html#t:PFqTag">PFqTag</a>)</li><li class="src short"><a href="#v:openTx">openTx</a> :: Int -&gt; Int -&gt; IO (ForeignPtr <a href="Network-PFq.html#t:PFqTag">PFqTag</a>)</li><li class="src short"><a href="#v:openNoGroup">openNoGroup</a> :: Int -&gt; Int -&gt; Int -&gt; IO (ForeignPtr <a href="Network-PFq.html#t:PFqTag">PFqTag</a>)</li><li class="src short"><a href="#v:openGroup">openGroup</a> :: [<a href="Network-PFq.html#t:ClassMask">ClassMask</a>] -&gt; <a href="Network-PFq.html#t:GroupPolicy">GroupPolicy</a> -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; IO (ForeignPtr <a href="Network-PFq.html#t:PFqTag">PFqTag</a>)</li><li class="src short"><a href="#v:close">close</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; IO ()</li><li class="src short"><a href="#v:enable">enable</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; IO ()</li><li class="src short"><a href="#v:disable">disable</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; IO ()</li><li class="src short"><a href="#v:getId">getId</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; IO Int</li><li class="src short"><a href="#v:getGroupId">getGroupId</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; IO Int</li><li class="src short"><a href="#v:isEnabled">isEnabled</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; IO Bool</li><li class="src short"><a href="#v:bind">bind</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; String -&gt; Int -&gt; IO ()</li><li class="src short"><a href="#v:bindGroup">bindGroup</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; Int -&gt; String -&gt; Int -&gt; IO ()</li><li class="src short"><a href="#v:unbind">unbind</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; String -&gt; Int -&gt; IO ()</li><li class="src short"><a href="#v:unbindGroup">unbindGroup</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; Int -&gt; String -&gt; Int -&gt; IO ()</li><li class="src short"><a href="#v:joinGroup">joinGroup</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; Int -&gt; [<a href="Network-PFq.html#t:ClassMask">ClassMask</a>] -&gt; <a href="Network-PFq.html#t:GroupPolicy">GroupPolicy</a> -&gt; IO ()</li><li class="src short"><a href="#v:leaveGroup">leaveGroup</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; Int -&gt; IO ()</li><li class="src short"><a href="#v:setTimestamp">setTimestamp</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; Bool -&gt; IO ()</li><li class="src short"><a href="#v:getTimestamp">getTimestamp</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; IO Bool</li><li class="src short"><a href="#v:setPromisc">setPromisc</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; String -&gt; Bool -&gt; IO ()</li><li class="src short"><a href="#v:read">read</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; Int -&gt; IO <a href="Network-PFq.html#t:NetQueue">NetQueue</a></li><li class="src short"><a href="#v:dispatch">dispatch</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; <a href="Network-PFq.html#t:Callback">Callback</a> -&gt; Int -&gt; IO ()</li><li class="src short"><a href="#v:getPackets">getPackets</a> :: <a href="Network-PFq.html#t:NetQueue">NetQueue</a> -&gt; IO [<a href="Network-PFq.html#t:Packet">Packet</a>]</li><li class="src short"><a href="#v:getPacketHeader">getPacketHeader</a> :: <a href="Network-PFq.html#t:Packet">Packet</a> -&gt; IO <a href="Network-PFq.html#t:PktHdr">PktHdr</a></li><li class="src short"><a href="#v:isPacketReady">isPacketReady</a> :: <a href="Network-PFq.html#t:Packet">Packet</a> -&gt; IO Bool</li><li class="src short"><a href="#v:waitForPacket">waitForPacket</a> :: <a href="Network-PFq.html#t:Packet">Packet</a> -&gt; IO ()</li><li class="src short"><a href="#v:getCaplen">getCaplen</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; IO Int</li><li class="src short"><a href="#v:setCaplen">setCaplen</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; Int -&gt; IO ()</li><li class="src short"><a href="#v:getOffset">getOffset</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; IO Int</li><li class="src short"><a href="#v:setOffset">setOffset</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; Int -&gt; IO ()</li><li class="src short"><a href="#v:getRxSlots">getRxSlots</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; IO Int</li><li class="src short"><a href="#v:setRxSlots">setRxSlots</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; Int -&gt; IO ()</li><li class="src short"><a href="#v:getRxSlotSize">getRxSlotSize</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; IO Int</li><li class="src short"><a href="#v:vlanFiltersEnabled">vlanFiltersEnabled</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; Int -&gt; Bool -&gt; IO ()</li><li class="src short"><a href="#v:vlanSetFilterId">vlanSetFilterId</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; Int -&gt; Int -&gt; IO ()</li><li class="src short"><a href="#v:vlanResetFilterId">vlanResetFilterId</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; Int -&gt; Int -&gt; IO ()</li><li class="src short"><a href="#v:bindTx">bindTx</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; String -&gt; Int -&gt; IO ()</li><li class="src short"><a href="#v:startTxThread">startTxThread</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; Int -&gt; IO ()</li><li class="src short"><a href="#v:stopTxThread">stopTxThread</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; IO ()</li><li class="src short"><a href="#v:wakeupTxThread">wakeupTxThread</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; IO ()</li><li class="src short"><a href="#v:txQueueFlush">txQueueFlush</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; IO ()</li><li class="src short"><a href="#v:inject">inject</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; ByteString -&gt; IO ()</li><li class="src short"><a href="#v:send">send</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; ByteString -&gt; IO ()</li><li class="src short"><a href="#v:sendSync">sendSync</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; ByteString -&gt; Int -&gt; IO ()</li><li class="src short"><a href="#v:sendAsync">sendAsync</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; ByteString -&gt; Int -&gt; IO ()</li><li class="src short"><a href="#v:getTxSlots">getTxSlots</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; IO Int</li><li class="src short"><a href="#v:setTxSlots">setTxSlots</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; Int -&gt; IO ()</li><li class="src short"><a href="#v:getMaxlen">getMaxlen</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; IO Int</li><li class="src short"><a href="#v:setMaxlen">setMaxlen</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; Int -&gt; IO ()</li><li class="src short"><a href="#v:groupComputation">groupComputation</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; Int -&gt; <a href="Network-PFq-Lang.html#t:Computation">Computation</a> <a href="Network-PFq-Lang.html#t:QFunction">QFunction</a> -&gt; IO ()</li><li class="src short"><a href="#v:getStats">getStats</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; IO <a href="Network-PFq.html#t:Statistics">Statistics</a></li><li class="src short"><a href="#v:getGroupStats">getGroupStats</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; Int -&gt; IO <a href="Network-PFq.html#t:Statistics">Statistics</a></li><li class="src short"><a href="#v:getGroupCounters">getGroupCounters</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; Int -&gt; IO Counters</li></ul></div><div id="interface"><h1 id="g:1">Types
</h1><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:PFqTag" class="def">PFqTag</a>  </p><div class="doc"><p>Packet capture handle.
</p></div></div><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:Statistics" class="def">Statistics</a>  </p><div class="doc"><p>PFq statistics.
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Statistics" class="def">Statistics</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:sReceived" class="def">sReceived</a> :: Integer</dt><dd class="doc"><p>packets received
</p></dd><dt class="src"><a name="v:sLost" class="def">sLost</a> :: Integer</dt><dd class="doc"><p>packets lost
</p></dd><dt class="src"><a name="v:sDropped" class="def">sDropped</a> :: Integer</dt><dd class="doc"><p>packets dropped
</p></dd><dt class="src"><a name="v:sSent" class="def">sSent</a> :: Integer</dt><dd class="doc"><p>packets sent
</p></dd><dt class="src"><a name="v:sDiscard" class="def">sDiscard</a> :: Integer</dt><dd class="doc"><p>packets discarded
</p></dd></dl><div class="clear"></div></div></td></tr></table></div><div class="subs instances"><p id="control.i:Statistics" class="caption collapser" onclick="toggleSection('i:Statistics')">Instances</p><div id="section.i:Statistics" class="show"><table><tr><td class="src">Eq <a href="Network-PFq.html#t:Statistics">Statistics</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Show <a href="Network-PFq.html#t:Statistics">Statistics</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:NetQueue" class="def">NetQueue</a>  </p><div class="doc"><p>Capture Queue handle.
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:NetQueue" class="def">NetQueue</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:qPtr" class="def">qPtr</a> :: Ptr <a href="Network-PFq.html#t:PktHdr">PktHdr</a></dt><dd class="doc"><p>pointer to the memory mapped queue
</p></dd><dt class="src"><a name="v:qLen" class="def">qLen</a> :: !Word64</dt><dd class="doc"><p>queue length
</p></dd><dt class="src"><a name="v:qSlotSize" class="def">qSlotSize</a> :: !Word64</dt><dd class="doc"><p>size of a slot = pfq header + packet
</p></dd><dt class="src"><a name="v:qIndex" class="def">qIndex</a> :: !Word32</dt><dd class="doc"><p>index of the queue
</p></dd></dl><div class="clear"></div></div></td></tr></table></div><div class="subs instances"><p id="control.i:NetQueue" class="caption collapser" onclick="toggleSection('i:NetQueue')">Instances</p><div id="section.i:NetQueue" class="show"><table><tr><td class="src">Eq <a href="Network-PFq.html#t:NetQueue">NetQueue</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Show <a href="Network-PFq.html#t:NetQueue">NetQueue</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:Packet" class="def">Packet</a>  </p><div class="doc"><p>Descriptor of the packet.
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Packet" class="def">Packet</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:pHdr" class="def">pHdr</a> :: Ptr <a href="Network-PFq.html#t:PktHdr">PktHdr</a></dt><dd class="doc"><p>pointer to pfq packet header
</p></dd><dt class="src"><a name="v:pData" class="def">pData</a> :: Ptr Word8</dt><dd class="doc"><p>pointer to the packet data
</p></dd><dt class="src"><a name="v:pIndex" class="def">pIndex</a> :: !Word32</dt><dd class="doc"><p>index of the queue
</p></dd></dl><div class="clear"></div></div></td></tr></table></div><div class="subs instances"><p id="control.i:Packet" class="caption collapser" onclick="toggleSection('i:Packet')">Instances</p><div id="section.i:Packet" class="show"><table><tr><td class="src">Eq <a href="Network-PFq.html#t:Packet">Packet</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Show <a href="Network-PFq.html#t:Packet">Packet</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:PktHdr" class="def">PktHdr</a>  </p><div class="doc"><p>PFq packet header.
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:PktHdr" class="def">PktHdr</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:hData" class="def">hData</a> :: !Word64</dt><dd class="doc"><p>opaque 64-bits mark
</p></dd><dt class="src"><a name="v:hSec" class="def">hSec</a> :: !Word32</dt><dd class="doc"><p>timestamp (seconds)
</p></dd><dt class="src"><a name="v:hNsec" class="def">hNsec</a> :: !Word32</dt><dd class="doc"><p>timestamp (nanoseconds)
</p></dd><dt class="src"><a name="v:hIfIndex" class="def">hIfIndex</a> :: !Word32</dt><dd class="doc"><p>interface index
</p></dd><dt class="src"><a name="v:hGid" class="def">hGid</a> :: !Word32</dt><dd class="doc"><p>group id
</p></dd><dt class="src"><a name="v:hLen" class="def">hLen</a> :: !Word16</dt><dd class="doc"><p>packet length (wire size)
</p></dd><dt class="src"><a name="v:hCapLen" class="def">hCapLen</a> :: !Word16</dt><dd class="doc"><p>capture length
</p></dd><dt class="src"><a name="v:hTci" class="def">hTci</a> :: !Word16</dt><dd class="doc"><p>vlan tci
</p></dd><dt class="src"><a name="v:hHwQueue" class="def">hHwQueue</a> :: !Word8</dt><dd class="doc"><p>hardware queue index
</p></dd><dt class="src"><a name="v:hCommit" class="def">hCommit</a> :: !Word8</dt><dd class="doc"><p>commit bit
</p></dd></dl><div class="clear"></div></div></td></tr></table></div><div class="subs instances"><p id="control.i:PktHdr" class="caption collapser" onclick="toggleSection('i:PktHdr')">Instances</p><div id="section.i:PktHdr" class="show"><table><tr><td class="src">Eq <a href="Network-PFq.html#t:PktHdr">PktHdr</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Show <a href="Network-PFq.html#t:PktHdr">PktHdr</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:Callback" class="def">Callback</a> = <a href="Network-PFq.html#t:PktHdr">PktHdr</a> -&gt; Ptr Word8 -&gt; IO ()</p><div class="doc"><p>The type of the callback function passed to <code><a href="Network-PFq.html#v:dispatch">dispatch</a></code>.
</p></div></div><div class="top"><p class="src"><span class="keyword">newtype</span>  <a name="t:ClassMask" class="def">ClassMask</a>  </p><div class="doc"><p>ClassMask type.
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:ClassMask" class="def">ClassMask</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:getClassMask" class="def">getClassMask</a> :: CULong</dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr></table></div><div class="subs instances"><p id="control.i:ClassMask" class="caption collapser" onclick="toggleSection('i:ClassMask')">Instances</p><div id="section.i:ClassMask" class="show"><table><tr><td class="src">Eq <a href="Network-PFq.html#t:ClassMask">ClassMask</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Show <a href="Network-PFq.html#t:ClassMask">ClassMask</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:class_default" class="def">class_default</a> :: <a href="Network-PFq.html#t:ClassMask">ClassMask</a></p></div><div class="top"><p class="src"><a name="v:class_any" class="def">class_any</a> :: <a href="Network-PFq.html#t:ClassMask">ClassMask</a></p></div><div class="top"><p class="src"><span class="keyword">newtype</span>  <a name="t:GroupPolicy" class="def">GroupPolicy</a>  </p><div class="doc"><p>Group policy type.
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:GroupPolicy" class="def">GroupPolicy</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:getGroupPolicy" class="def">getGroupPolicy</a> :: CInt</dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr></table></div><div class="subs instances"><p id="control.i:GroupPolicy" class="caption collapser" onclick="toggleSection('i:GroupPolicy')">Instances</p><div id="section.i:GroupPolicy" class="show"><table><tr><td class="src">Eq <a href="Network-PFq.html#t:GroupPolicy">GroupPolicy</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Show <a href="Network-PFq.html#t:GroupPolicy">GroupPolicy</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:policy_undefined" class="def">policy_undefined</a> :: <a href="Network-PFq.html#t:GroupPolicy">GroupPolicy</a></p></div><div class="top"><p class="src"><a name="v:policy_priv" class="def">policy_priv</a> :: <a href="Network-PFq.html#t:GroupPolicy">GroupPolicy</a></p></div><div class="top"><p class="src"><a name="v:policy_restricted" class="def">policy_restricted</a> :: <a href="Network-PFq.html#t:GroupPolicy">GroupPolicy</a></p></div><div class="top"><p class="src"><a name="v:policy_shared" class="def">policy_shared</a> :: <a href="Network-PFq.html#t:GroupPolicy">GroupPolicy</a></p></div><div class="top"><p class="src"><span class="keyword">newtype</span>  <a name="t:PFqConstant" class="def">PFqConstant</a>  </p><div class="doc"><p>Generic pfq constant.
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:PFqConstant" class="def">PFqConstant</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:getConstant" class="def">getConstant</a> :: Int</dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr></table></div><div class="subs instances"><p id="control.i:PFqConstant" class="caption collapser" onclick="toggleSection('i:PFqConstant')">Instances</p><div id="section.i:PFqConstant" class="show"><table><tr><td class="src">Eq <a href="Network-PFq.html#t:PFqConstant">PFqConstant</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Show <a href="Network-PFq.html#t:PFqConstant">PFqConstant</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><h1 id="g:2">Socket and Groups
</h1><div class="top"><p class="src"><a name="v:open" class="def">open</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Int</td><td class="doc"><p>caplen
</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>offset
</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>number of rx slots
</p></td></tr><tr><td class="src">-&gt; IO (ForeignPtr <a href="Network-PFq.html#t:PFqTag">PFqTag</a>)</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Open a socket and join a new group.
</p><p>The default values for class mask and group policy are <code><a href="Network-PFq.html#v:class_default">class_default</a></code> and
 <code><a href="Network-PFq.html#v:policy_priv">policy_priv</a></code>, respectively.
</p></div></div><div class="top"><p class="src"><a name="v:openTx" class="def">openTx</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Int</td><td class="doc"><p>maxlen
</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>number of tx slots
</p></td></tr><tr><td class="src">-&gt; IO (ForeignPtr <a href="Network-PFq.html#t:PFqTag">PFqTag</a>)</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Open the socket for transmission. No group is joined.
</p><p>The group policy is <code><a href="Network-PFq.html#v:policy_undefined">policy_undefined</a></code> by default.
</p></div></div><div class="top"><p class="src"><a name="v:openNoGroup" class="def">openNoGroup</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Int</td><td class="doc"><p>caplen
</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>offset
</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>number of rx slots
</p></td></tr><tr><td class="src">-&gt; IO (ForeignPtr <a href="Network-PFq.html#t:PFqTag">PFqTag</a>)</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Open a socket. No group is joined.
</p><p>Groups can later be joined by means of the <code><a href="Network-PFq.html#v:joinGroup">joinGroup</a></code> function.
</p></div></div><div class="top"><p class="src"><a name="v:openGroup" class="def">openGroup</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [<a href="Network-PFq.html#t:ClassMask">ClassMask</a>]</td><td class="doc"><p>list of ClassMask (i.e. [class_default])
</p></td></tr><tr><td class="src">-&gt; <a href="Network-PFq.html#t:GroupPolicy">GroupPolicy</a></td><td class="doc"><p>policy for the group
</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>caplen
</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>offset
</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>number of rx slots
</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>maxlen
</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>number of tx slots
</p></td></tr><tr><td class="src">-&gt; IO (ForeignPtr <a href="Network-PFq.html#t:PFqTag">PFqTag</a>)</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Open a socket.
</p><p>Both class mask and group policy are specifiable.
</p></div></div><div class="top"><p class="src"><a name="v:close" class="def">close</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; IO ()</p><div class="doc"><p>Close the socket.
</p></div></div><div class="top"><p class="src"><a name="v:enable" class="def">enable</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; IO ()</p><div class="doc"><p>Enable the socket for packet capture.
</p></div></div><div class="top"><p class="src"><a name="v:disable" class="def">disable</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; IO ()</p><div class="doc"><p>Disable the socket for packet capture.
</p></div></div><div class="top"><p class="src"><a name="v:getId" class="def">getId</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; IO Int</p><div class="doc"><p>Return the id of the socket.
</p></div></div><div class="top"><p class="src"><a name="v:getGroupId" class="def">getGroupId</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; IO Int</p><div class="doc"><p>Return the group id of the socket.
</p></div></div><div class="top"><p class="src"><a name="v:isEnabled" class="def">isEnabled</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; IO Bool</p><div class="doc"><p>Check whether the packet capture is enabled.
</p></div></div><div class="top"><p class="src"><a name="v:bind" class="def">bind</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; String</td><td class="doc"><p>device name
</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>queue index (-1 means any queue)
</p></td></tr><tr><td class="src">-&gt; IO ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Bind the main group of the socket to the given device/queue.
</p></div></div><div class="top"><p class="src"><a name="v:bindGroup" class="def">bindGroup</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>group id
</p></td></tr><tr><td class="src">-&gt; String</td><td class="doc"><p>device name
</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>queue index
</p></td></tr><tr><td class="src">-&gt; IO ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Bind the group to the given device/queue.
</p></div></div><div class="top"><p class="src"><a name="v:unbind" class="def">unbind</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; String</td><td class="doc"><p>device name
</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>queue index
</p></td></tr><tr><td class="src">-&gt; IO ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Unbind the main group of the socket from the given device/queue.
</p></div></div><div class="top"><p class="src"><a name="v:unbindGroup" class="def">unbindGroup</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>group id
</p></td></tr><tr><td class="src">-&gt; String</td><td class="doc"><p>device name
</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>queue index
</p></td></tr><tr><td class="src">-&gt; IO ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Unbind the group from the given device/queue.
</p></div></div><div class="top"><p class="src"><a name="v:joinGroup" class="def">joinGroup</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>group id
</p></td></tr><tr><td class="src">-&gt; [<a href="Network-PFq.html#t:ClassMask">ClassMask</a>]</td><td class="doc"><p>class mask list
</p></td></tr><tr><td class="src">-&gt; <a href="Network-PFq.html#t:GroupPolicy">GroupPolicy</a></td><td class="doc"><p>group policy
</p></td></tr><tr><td class="src">-&gt; IO ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Join the group with the given class mask and group policy.
</p></div></div><div class="top"><p class="src"><a name="v:leaveGroup" class="def">leaveGroup</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>group id
</p></td></tr><tr><td class="src">-&gt; IO ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Leave the group.
</p></div></div><div class="top"><p class="src"><a name="v:setTimestamp" class="def">setTimestamp</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; Bool</td><td class="doc"><p>toggle: true is on, false is off.
</p></td></tr><tr><td class="src">-&gt; IO ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Set the timestamping for packets.
</p></div></div><div class="top"><p class="src"><a name="v:getTimestamp" class="def">getTimestamp</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; IO Bool</p><div class="doc"><p>Check whether the timestamping for packets is enabled.
</p></div></div><div class="top"><p class="src"><a name="v:setPromisc" class="def">setPromisc</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; String</td><td class="doc"><p>device name
</p></td></tr><tr><td class="src">-&gt; Bool</td><td class="doc"><p>toggle: true is on, false is off.
</p></td></tr><tr><td class="src">-&gt; IO ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Set the promiscuous mode for the given interface.
</p></div></div><h1 id="g:3">Packet capture
</h1><div class="top"><p class="src"><a name="v:read" class="def">read</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>timeout (msec)
</p></td></tr><tr><td class="src">-&gt; IO <a href="Network-PFq.html#t:NetQueue">NetQueue</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Read packets in place.
</p><p>Wait for packets and return a <code><a href="Network-PFq.html#t:NetQueue">NetQueue</a></code> descriptor.
 The timeout is specified in microseconds.
</p></div></div><div class="top"><p class="src"><a name="v:dispatch" class="def">dispatch</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="Network-PFq.html#t:Callback">Callback</a></td><td class="doc"><p>packet processing function
</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>timeout (msec)
</p></td></tr><tr><td class="src">-&gt; IO ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Collect and process packets.
</p><p>This function is passed a function <code><a href="Network-PFq.html#t:Callback">Callback</a></code> which is called on each packet.
</p></div></div><div class="top"><p class="src"><a name="v:getPackets" class="def">getPackets</a> :: <a href="Network-PFq.html#t:NetQueue">NetQueue</a> -&gt; IO [<a href="Network-PFq.html#t:Packet">Packet</a>]</p><div class="doc"><p>Return the list of <code><a href="Network-PFq.html#t:Packet">Packet</a></code> stored in the <code><a href="Network-PFq.html#t:NetQueue">NetQueue</a></code>.
</p></div></div><div class="top"><p class="src"><a name="v:getPacketHeader" class="def">getPacketHeader</a> :: <a href="Network-PFq.html#t:Packet">Packet</a> -&gt; IO <a href="Network-PFq.html#t:PktHdr">PktHdr</a></p><div class="doc"><p>Return the <code><a href="Network-PFq.html#t:PktHdr">PktHdr</a></code> of the given the <code><a href="Network-PFq.html#t:Packet">Packet</a></code>.
</p></div></div><div class="top"><p class="src"><a name="v:isPacketReady" class="def">isPacketReady</a> :: <a href="Network-PFq.html#t:Packet">Packet</a> -&gt; IO Bool</p><div class="doc"><p>Check whether the <code><a href="Network-PFq.html#t:Packet">Packet</a></code> is ready or not.
</p></div></div><div class="top"><p class="src"><a name="v:waitForPacket" class="def">waitForPacket</a> :: <a href="Network-PFq.html#t:Packet">Packet</a> -&gt; IO ()</p><div class="doc"><p>Wait until the <code><a href="Network-PFq.html#t:Packet">Packet</a></code> is ready.
</p></div></div><div class="top"><p class="src"><a name="v:getCaplen" class="def">getCaplen</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; IO Int</p><div class="doc"><p>Return the capture length of packets, in bytes.
</p></div></div><div class="top"><p class="src"><a name="v:setCaplen" class="def">setCaplen</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>caplen (bytes)
</p></td></tr><tr><td class="src">-&gt; IO ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Specify the capture length of packets, in bytes.
</p><p>Capture length must be set before the socket is enabled for capture.
</p></div></div><div class="top"><p class="src"><a name="v:getOffset" class="def">getOffset</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; IO Int</p><div class="doc"><p>Return the capture offset of packets.
</p></div></div><div class="top"><p class="src"><a name="v:setOffset" class="def">setOffset</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>offset
</p></td></tr><tr><td class="src">-&gt; IO ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Specify the capture offset of packets, in bytes.
</p></div></div><div class="top"><p class="src"><a name="v:getRxSlots" class="def">getRxSlots</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; IO Int</p><div class="doc"><p>Return the length of the RX queue, in number of packets.
</p></div></div><div class="top"><p class="src"><a name="v:setRxSlots" class="def">setRxSlots</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>number of rx slots
</p></td></tr><tr><td class="src">-&gt; IO ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Specify the length of the RX queue, in number of packets./
</p><p>The number of RX slots can't exceed the max value specified by
 the rx_queue_slot kernel module parameter.
</p></div></div><div class="top"><p class="src"><a name="v:getRxSlotSize" class="def">getRxSlotSize</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; IO Int</p><div class="doc"><p>Return the length of a RX slot, in bytes.
</p></div></div><div class="top"><p class="src"><a name="v:vlanFiltersEnabled" class="def">vlanFiltersEnabled</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>group id
</p></td></tr><tr><td class="src">-&gt; Bool</td><td class="doc"><p>toggle: true is on, false is off.
</p></td></tr><tr><td class="src">-&gt; IO ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Set the vlan filtering for the given group.
</p></div></div><div class="top"><p class="src"><a name="v:vlanSetFilterId" class="def">vlanSetFilterId</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>group id
</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>vlan id
</p></td></tr><tr><td class="src">-&gt; IO ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Specify a capture filter for the given group and vlan id.
</p></div></div><div class="top"><p class="src"><a name="v:vlanResetFilterId" class="def">vlanResetFilterId</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>group id
</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>vlan id
</p></td></tr><tr><td class="src">-&gt; IO ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Reset the vlan filter.
</p></div></div><h1 id="g:4">Packet transmission
</h1><div class="top"><p class="src"><a name="v:bindTx" class="def">bindTx</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; String -&gt; Int -&gt; IO ()</p><div class="doc"><p>Bind the socket for transmission to the given device name and queue.
</p><p>A socket for transmission can be bound to a given device/queue at time.
</p></div></div><div class="top"><p class="src"><a name="v:startTxThread" class="def">startTxThread</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>node
</p></td></tr><tr><td class="src">-&gt; IO ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Start the TX kernel thread for transmission.
</p></div></div><div class="top"><p class="src"><a name="v:stopTxThread" class="def">stopTxThread</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; IO ()</p><div class="doc"><p>Stop the TX kernel thread.
</p></div></div><div class="top"><p class="src"><a name="v:wakeupTxThread" class="def">wakeupTxThread</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; IO ()</p><div class="doc"><p>Wakeup the TX kernel thread.
</p><p>Wake up the TX kernel thread which transmits the packets in the Tx queue.
 The kernel thread must be already started.
</p></div></div><div class="top"><p class="src"><a name="v:txQueueFlush" class="def">txQueueFlush</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; IO ()</p><div class="doc"><p>Flush the TX queue, in the user context of the calling thread.
</p><p>To invoke this function, no kernel thread is required.
</p></div></div><div class="top"><p class="src"><a name="v:inject" class="def">inject</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; ByteString</td><td class="doc"><p>bytes of packet
</p></td></tr><tr><td class="src">-&gt; IO ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Schedule the packet for transmission.
</p><p>The packet is copied into the TX queue and sent when
 the <code><a href="Network-PFq.html#v:txQueueFlush">txQueueFlush</a></code> or the <code><a href="Network-PFq.html#v:wakeupTxThread">wakeupTxThread</a></code> function is invoked.
</p></div></div><div class="top"><p class="src"><a name="v:send" class="def">send</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; ByteString</td><td class="doc"><p>bytes of packet
</p></td></tr><tr><td class="src">-&gt; IO ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Transmit the packet passed.
</p><p>The packet is copied into the TX queue and sent immediately.
</p></div></div><div class="top"><p class="src"><a name="v:sendSync" class="def">sendSync</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; ByteString</td><td class="doc"><p>bytes of packet
</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>length of the batch
</p></td></tr><tr><td class="src">-&gt; IO ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Store the packet and possibly transmit the packets in the queue, synchronously.
</p><p>The transmission is invoked every n packets enqueued.
</p></div></div><div class="top"><p class="src"><a name="v:sendAsync" class="def">sendAsync</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; ByteString</td><td class="doc"><p>bytes of packet
</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>length of the batch
</p></td></tr><tr><td class="src">-&gt; IO ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Store the packet and possibly transmit the packets in the queue, asynchronously.
</p><p>The transmission is invoked by the kernel thread, every n packets enqueued.
</p></div></div><div class="top"><p class="src"><a name="v:getTxSlots" class="def">getTxSlots</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; IO Int</p><div class="doc"><p>Return the length of the TX queue, in number of packets.
</p></div></div><div class="top"><p class="src"><a name="v:setTxSlots" class="def">setTxSlots</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>numer of tx slots
</p></td></tr><tr><td class="src">-&gt; IO ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Specify the length of the TX queue, in number of packets.
</p><p>The number of TX slots can't exceed the max value specified by
 the tx_queue_slot kernel module parameter.
</p></div></div><div class="top"><p class="src"><a name="v:getMaxlen" class="def">getMaxlen</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; IO Int</p><div class="doc"><p>Return the max transmission length of packets, in bytes.
</p></div></div><div class="top"><p class="src"><a name="v:setMaxlen" class="def">setMaxlen</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; Int -&gt; IO ()</p><div class="doc"><p>Specify the max transmission length of packets, in bytes.
</p></div></div><h1 id="g:5">Q-lang
</h1><div class="top"><p class="src"><a name="v:groupComputation" class="def">groupComputation</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>group id
</p></td></tr><tr><td class="src">-&gt; <a href="Network-PFq-Lang.html#t:Computation">Computation</a> <a href="Network-PFq-Lang.html#t:QFunction">QFunction</a></td><td class="doc"><p>computation (PFqLang)
</p></td></tr><tr><td class="src">-&gt; IO ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Specify a functional computation for the given group.
</p><p>The functional computation is specified by the q-lan eDLS.
</p></div></div><h1 id="g:6">Statistics and counters
</h1><div class="top"><p class="src"><a name="v:getStats" class="def">getStats</a> :: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a> -&gt; IO <a href="Network-PFq.html#t:Statistics">Statistics</a></p><div class="doc"><p>Return the socket statistics.
</p></div></div><div class="top"><p class="src"><a name="v:getGroupStats" class="def">getGroupStats</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>group id
</p></td></tr><tr><td class="src">-&gt; IO <a href="Network-PFq.html#t:Statistics">Statistics</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Return the statistics of the given group.
</p></div></div><div class="top"><p class="src"><a name="v:getGroupCounters" class="def">getGroupCounters</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Ptr <a href="Network-PFq.html#t:PFqTag">PFqTag</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>group id
</p></td></tr><tr><td class="src">-&gt; IO Counters</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Return the set of counters of the given group.
</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.13.2</p></div></body></html>